{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["/builds/test/test/.gitlab-ci.yml", "/builds/test/test/Dockerfile", "/builds/test/test/LICENSE", "/builds/test/test/README.md", "/builds/test/test/db/schema.sql", "/builds/test/test/docker-compose.yml", "/builds/test/test/docs/.gitignore", "/builds/test/test/docs/README.md", "/builds/test/test/docs/SUMMARY.md", "/builds/test/test/docs/assessment/a1-injection.md", "/builds/test/test/docs/assessment/a3-cross-site-scripting.md", "/builds/test/test/docs/assessment/a4-insecure-direct-object-reference.md", "/builds/test/test/docs/assets/cmdi.png", "/builds/test/test/docs/assets/intellij_hw.png", "/builds/test/test/docs/assets/mysql_wb.png", "/builds/test/test/docs/assets/sqli.png", "/builds/test/test/docs/assets/struts2_hw.png", "/builds/test/test/docs/development/application-bootstrap.md", "/builds/test/test/docs/development/crud-on-model.md", "/builds/test/test/docs/development/database-development.md", "/builds/test/test/docs/development/spring-framework-primer.md", "/builds/test/test/docs/development/struts2-framework-primer.md", "/builds/test/test/docs/solution/a1-injection.md", "/builds/test/test/docs/solution/a10-unvalidated-redirects-and-forwards.md", "/builds/test/test/docs/solution/a2-broken-authentication-and-session-management.md", "/builds/test/test/docs/solution/a3-cross-site-scripting.md", "/builds/test/test/docs/solution/a4-insecure-direct-object-reference.md", "/builds/test/test/docs/solution/a5-security-misconfiguration.md", "/builds/test/test/docs/solution/a6-sensitive-data-exposure.md", "/builds/test/test/docs/solution/a7-missing-function-level-access-control.md", "/builds/test/test/docs/solution/a8-cross-site-request-forgery.md", "/builds/test/test/docs/solution/a9-using-components-with-known-vulnerability.md", "/builds/test/test/pom.xml", "/builds/test/test/scripts/start.sh", "/builds/test/test/src/main/java/com/appsecco/dvja/Constant.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/ApiAction.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/BaseController.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/Home.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/Login.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/PingAction.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/ProductAction.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/RedirectAction.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/Register.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/ResetPassword.java", "/builds/test/test/src/main/java/com/appsecco/dvja/controllers/UserAction.java", "/builds/test/test/src/main/java/com/appsecco/dvja/interceptors/AuthenticationInterceptor.java", "/builds/test/test/src/main/java/com/appsecco/dvja/models/Product.java", "/builds/test/test/src/main/java/com/appsecco/dvja/models/User.java", "/builds/test/test/src/main/java/com/appsecco/dvja/services/ProductService.java", "/builds/test/test/src/main/java/com/appsecco/dvja/services/UserAuthenticationService.java", "/builds/test/test/src/main/java/com/appsecco/dvja/services/UserRegistrationService.java", "/builds/test/test/src/main/java/com/appsecco/dvja/services/UserService.java", "/builds/test/test/src/main/java/com/appsecco/example/ExampleSupport.java", "/builds/test/test/src/main/java/com/appsecco/example/HelloWorld.java", "/builds/test/test/src/main/java/com/appsecco/example/Login.java", "/builds/test/test/src/main/resources/META-INF/persistence.xml", "/builds/test/test/src/main/resources/com/appsecco/example/Login-validation.xml", "/builds/test/test/src/main/resources/com/appsecco/example/package.properties", "/builds/test/test/src/main/resources/com/appsecco/example/package_es.properties", "/builds/test/test/src/main/resources/example.xml", "/builds/test/test/src/main/resources/log4j2.xml", "/builds/test/test/src/main/resources/struts.xml", "/builds/test/test/src/main/webapp/WEB-INF/applicationContext.xml", "/builds/test/test/src/main/webapp/WEB-INF/config.properties", "/builds/test/test/src/main/webapp/WEB-INF/dvja/AssessmentHome.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/Home.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/Login.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/Ping.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/ProductEdit.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/ProductList.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/Registration.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/RegistrationSuccess.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/ResetPasswordInput.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/ResetPasswordStart.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/ResetPasswordSuccess.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/UserEdit.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/UserSearch.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a10_redirect/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a10_redirect/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a10_redirect/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a10_redirect.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a1_injection/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a1_injection/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a1_injection/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a1_injection.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a2_broken_auth/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a2_broken_auth/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a2_broken_auth/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a2_broken_auth.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a3_xss/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a3_xss/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a3_xss/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a3_xss.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a4_idor/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a4_idor/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a4_idor/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a4_idor.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a5_sec_misconf/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a5_sec_misconf/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a5_sec_misconf/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a5_sec_misconf.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a6_sensitive_data/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a6_sensitive_data/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a6_sensitive_data/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a6_sensitive_data.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a7_missing_access_control/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a7_missing_access_control/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a7_missing_access_control/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a7_missing_access_control.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a8_csrf/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a8_csrf/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a8_csrf/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a8_csrf.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a9_vuln_component/description.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a9_vuln_component/reference.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a9_vuln_component/scenario.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/a9_vuln_component.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/common/Footer.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/common/Head.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/common/Menu.jsp", "/builds/test/test/src/main/webapp/WEB-INF/dvja/common/Navigation.jsp", "/builds/test/test/src/main/webapp/WEB-INF/example/HelloWorld.jsp", "/builds/test/test/src/main/webapp/WEB-INF/example/Login.jsp", "/builds/test/test/src/main/webapp/WEB-INF/example/Menu.jsp", "/builds/test/test/src/main/webapp/WEB-INF/example/Missing.jsp", "/builds/test/test/src/main/webapp/WEB-INF/example/Register.jsp", "/builds/test/test/src/main/webapp/WEB-INF/example/Welcome.jsp", "/builds/test/test/src/main/webapp/WEB-INF/web.xml", "/builds/test/test/src/main/webapp/assets/fa/css/font-awesome.css", "/builds/test/test/src/main/webapp/assets/fa/css/font-awesome.min.css", "/builds/test/test/src/main/webapp/assets/fa/fonts/FontAwesome.otf", "/builds/test/test/src/main/webapp/assets/fa/fonts/fontawesome-webfont.eot", "/builds/test/test/src/main/webapp/assets/fa/fonts/fontawesome-webfont.svg", "/builds/test/test/src/main/webapp/assets/fa/fonts/fontawesome-webfont.ttf", "/builds/test/test/src/main/webapp/assets/fa/fonts/fontawesome-webfont.woff", "/builds/test/test/src/main/webapp/assets/fa/fonts/fontawesome-webfont.woff2", "/builds/test/test/src/main/webapp/assets/fa/less/animated.less", "/builds/test/test/src/main/webapp/assets/fa/less/bordered-pulled.less", "/builds/test/test/src/main/webapp/assets/fa/less/core.less", "/builds/test/test/src/main/webapp/assets/fa/less/fixed-width.less", "/builds/test/test/src/main/webapp/assets/fa/less/font-awesome.less", "/builds/test/test/src/main/webapp/assets/fa/less/icons.less", "/builds/test/test/src/main/webapp/assets/fa/less/larger.less", "/builds/test/test/src/main/webapp/assets/fa/less/list.less", "/builds/test/test/src/main/webapp/assets/fa/less/mixins.less", "/builds/test/test/src/main/webapp/assets/fa/less/path.less", "/builds/test/test/src/main/webapp/assets/fa/less/rotated-flipped.less", "/builds/test/test/src/main/webapp/assets/fa/less/screen-reader.less", "/builds/test/test/src/main/webapp/assets/fa/less/stacked.less", "/builds/test/test/src/main/webapp/assets/fa/less/variables.less", "/builds/test/test/src/main/webapp/assets/fa/scss/_animated.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_bordered-pulled.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_core.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_fixed-width.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_icons.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_larger.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_list.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_mixins.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_path.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_rotated-flipped.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_screen-reader.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_stacked.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/_variables.scss", "/builds/test/test/src/main/webapp/assets/fa/scss/font-awesome.scss", "/builds/test/test/src/main/webapp/index.html"]}, "results": [{"check_id": "dockerfile.security.missing-user.missing-user", "end": {"col": 42, "line": 17, "offset": 340}, "extra": {"engine_kind": "OSS", "fingerprint": "735952209bc4d28002cacac7f0b37875955d2087939cf713b64b073b037c3312543f59cb09c66615cd370d00b9aed30c81cbe871b4106bff0dfc430453f6e929_0", "fix": "USER non-root\nCMD [\"sh\", \"-c\", \"/app/scripts/start.sh\"]", "is_ignored": false, "lines": "CMD [\"sh\", \"-c\", \"/app/scripts/start.sh\"]", "message": "By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-269: Improper Privilege Management"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A04:2021 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 20148, "rule_id": "AbUN06", "rv_id": 833486, "url": "https://semgrep.dev/playground/r/nWTy4lK/dockerfile.security.missing-user.missing-user", "version_id": "nWTy4lK"}}, "shortlink": "https://sg.run/Gbvn", "source": "https://semgrep.dev/r/dockerfile.security.missing-user.missing-user", "subcategory": ["audit"], "technology": ["dockerfile"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$...VARS": {"abstract_content": "[\"sh\"\"-c\"\"/app/scripts/start.sh\"]", "end": {"col": 42, "line": 17, "offset": 340}, "start": {"col": 5, "line": 17, "offset": 303}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/builds/test/test/Dockerfile", "start": {"col": 1, "line": 17, "offset": 299}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 3, "offset": 30}, "extra": {"engine_kind": "OSS", "fingerprint": "e4b2e8983de1b26ab9960862efcc4108f35f7577e613e4fdf4d581134d0be4937fdb9d931d5f6084f25112b04f47c2ff40e5fa9ba300f73303b3b462a9c99a83_0", "is_ignored": false, "lines": "  mysql:", "message": "Service 'mysql' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "mysql", "end": {"col": 8, "line": 3, "offset": 30}, "start": {"col": 3, "line": 3, "offset": 25}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/builds/test/test/docker-compose.yml", "start": {"col": 3, "line": 3, "offset": 25}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 3, "offset": 30}, "extra": {"engine_kind": "OSS", "fingerprint": "8025635fc16f05435a68cd2e09b55ea17bd86b6b8ea2d1062a88d371a8feb25425adbd0374b32ad76dd08324baf5585093f946d8669403d4834e777e75a1cca8_0", "is_ignored": false, "lines": "  mysql:", "message": "Service 'mysql' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "mysql", "end": {"col": 8, "line": 3, "offset": 30}, "start": {"col": 3, "line": 3, "offset": 25}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/builds/test/test/docker-compose.yml", "start": {"col": 3, "line": 3, "offset": 25}}, {"check_id": "java.lang.security.audit.formatted-sql-string.formatted-sql-string", "end": {"col": 110, "line": 48, "offset": 1492}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 110, "line": 48, "offset": 1492}, "path": "/builds/test/test/src/main/java/com/appsecco/dvja/services/ProductService.java", "start": {"col": 23, "line": 48, "offset": 1405}}, "entityManager.createQuery(\"SELECT p FROM Product p WHERE p.name LIKE '%\" + name + \"%'\")"]], "taint_source": ["CliLoc", [{"end": {"col": 102, "line": 48, "offset": 1484}, "path": "/builds/test/test/src/main/java/com/appsecco/dvja/services/ProductService.java", "start": {"col": 98, "line": 48, "offset": 1480}}, "name"]]}, "engine_kind": "OSS", "fingerprint": "8003a8878d772198e877db7b3a03e2147b758db2ac817da59895acfe4d7fd551220df39203aa3522590ef2f7cd4b04e208b9bb0c5e7c3f50b7406af3609fbbe2_0", "is_ignored": false, "lines": "        Query query = entityManager.createQuery(\"SELECT p FROM Product p WHERE p.name LIKE '%\" + name + \"%'\");", "message": "Detected a formatted string in a SQL statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Use a prepared statements (java.sql.PreparedStatement) instead. You can obtain a PreparedStatement using 'connection.prepareStatement'.", "metadata": {"asvs": {"control_id": "5.3.5 Injection", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements", "section": "V5: Validation, Sanitization and Encoding Verification Requirements", "version": "4"}, "category": "security", "confidence": "MEDIUM", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html", "https://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html#create_ps", "https://software-security.sans.org/developer-how-to/fix-sql-injection-in-java-using-prepared-callable-statement"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9175, "rule_id": "QrUzxR", "rv_id": 833949, "url": "https://semgrep.dev/playground/r/BjTe03J/java.lang.security.audit.formatted-sql-string.formatted-sql-string", "version_id": "BjTe03J"}}, "shortlink": "https://sg.run/OPXp", "source": "https://semgrep.dev/r/java.lang.security.audit.formatted-sql-string.formatted-sql-string", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#SQL_INJECTION", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$ANNOT": {"abstract_content": "List<Product>", "end": {"col": 25, "line": 47, "offset": 1348}, "start": {"col": 12, "line": 47, "offset": 1335}}, "$EM": {"abstract_content": "entityManager", "end": {"col": 36, "line": 48, "offset": 1418}, "start": {"col": 23, "line": 48, "offset": 1405}}, "$FUNC": {"abstract_content": "findContainingName", "end": {"col": 44, "line": 47, "offset": 1367}, "start": {"col": 26, "line": 47, "offset": 1349}}, "$SQLFUNC": {"abstract_content": "createQuery", "end": {"col": 48, "line": 48, "offset": 1430}, "start": {"col": 37, "line": 48, "offset": 1419}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/builds/test/test/src/main/java/com/appsecco/dvja/services/ProductService.java", "start": {"col": 23, "line": 48, "offset": 1405}}, {"check_id": "java.lang.security.audit.formatted-sql-string.formatted-sql-string", "end": {"col": 104, "line": 75, "offset": 2254}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 104, "line": 75, "offset": 2254}, "path": "/builds/test/test/src/main/java/com/appsecco/dvja/services/UserService.java", "start": {"col": 23, "line": 75, "offset": 2173}}, "entityManager.createQuery(\"SELECT u FROM User u WHERE u.login = '\" + login + \"'\")"]], "taint_source": ["CliLoc", [{"end": {"col": 97, "line": 75, "offset": 2247}, "path": "/builds/test/test/src/main/java/com/appsecco/dvja/services/UserService.java", "start": {"col": 92, "line": 75, "offset": 2242}}, "login"]]}, "engine_kind": "OSS", "fingerprint": "8ccb93f97bcd79128c9174f0df7c3046f0dc67c321b45cffde60081588a835ec44c3bf01aa5a1179ce47522467cc23c7c4ef5686f07e2254459e4cb9804145b5_0", "is_ignored": false, "lines": "        Query query = entityManager.createQuery(\"SELECT u FROM User u WHERE u.login = '\" + login + \"'\");", "message": "Detected a formatted string in a SQL statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Use a prepared statements (java.sql.PreparedStatement) instead. You can obtain a PreparedStatement using 'connection.prepareStatement'.", "metadata": {"asvs": {"control_id": "5.3.5 Injection", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements", "section": "V5: Validation, Sanitization and Encoding Verification Requirements", "version": "4"}, "category": "security", "confidence": "MEDIUM", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html", "https://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html#create_ps", "https://software-security.sans.org/developer-how-to/fix-sql-injection-in-java-using-prepared-callable-statement"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9175, "rule_id": "QrUzxR", "rv_id": 833949, "url": "https://semgrep.dev/playground/r/BjTe03J/java.lang.security.audit.formatted-sql-string.formatted-sql-string", "version_id": "BjTe03J"}}, "shortlink": "https://sg.run/OPXp", "source": "https://semgrep.dev/r/java.lang.security.audit.formatted-sql-string.formatted-sql-string", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#SQL_INJECTION", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$ANNOT": {"abstract_content": "User", "end": {"col": 16, "line": 74, "offset": 2116}, "start": {"col": 12, "line": 74, "offset": 2112}}, "$EM": {"abstract_content": "entityManager", "end": {"col": 36, "line": 75, "offset": 2186}, "start": {"col": 23, "line": 75, "offset": 2173}}, "$FUNC": {"abstract_content": "findByLoginUnsafe", "end": {"col": 34, "line": 74, "offset": 2134}, "start": {"col": 17, "line": 74, "offset": 2117}}, "$SQLFUNC": {"abstract_content": "createQuery", "end": {"col": 48, "line": 75, "offset": 2198}, "start": {"col": 37, "line": 75, "offset": 2187}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/builds/test/test/src/main/java/com/appsecco/dvja/services/UserService.java", "start": {"col": 23, "line": 75, "offset": 2173}}], "skipped_rules": [], "version": "1.91.0"}